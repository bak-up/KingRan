/*
变量：
JD_PROXY_OPEN      // 代理启用变量，默认不开启（true/false）
JD_PROXY_TUNNRL      // 代理池代理地址变量，默认不开启，仅支持代理池模式(auto-proxy-pool)，格式为：http://ip:port
JD_PROXY_URL      // API代理地址变量，默认不开启，仅支持 数据格式:txt;提取数量:每次一个，格式为：http://api.xxx.xxx
JD_NO_PROXY      // 禁止走代理，默认 127.0.0.1,*.baidu.com 需要自行修改
根据自行需要设定，脚本定时每25分钟自动执行一次

9.16更新：不再读取缓存，运行一次写入一次

cron:5/25 * * * *
============Quantumultx===============
[task_local]
#代理缓存Token
5/25 * * * * jd_token.js, tag=代理缓存Token, enabled=true

*/

const $ = new Env('代理缓存Token');
var version_='jsjiami.com.v7';const I1i11l1I=ll1iIIil;function i1ii111i(){const illl1IIi=(function(){return[...[version_,'GjhgtsjMiOUamiwd.wPcoNm.lGvq7RwtFbJUdbnu==','W7pdV8objhe','W6ZdQmoDm04N','u8oUyd7cGa','n2tdLCkn','WPjlW5OB','xsbFyspcGsy','W7JcTGRcIfW','WRpdIwS','W70LWOy','4PIu77U8W53cIqtcK8kOooE+KowSToAxREMwPdS','W4xcHSokdgmVWPPbWPdcKqZdRW','WPhdSZ7cKLm','rsVcPCktW5PQW4tdHq','b07dOSoJ','WOBdQq3cOgu','W5yJWOldVYC','W7lcLtFcINNdOW','W6pcKwJdIfa','emoWWPONW6S','WOhcJ8kRyZG9o8kozCoTW6/dLYfDywlcQJ9x','4PMe77IeWPhcTq9P5z+O5z2H5lIp55gy5BAG5B2Y5zkJ77+U','xJJdP1C','WR7dTSksBG','qhhcJmkpW5C','erGDWQ4','CSk4WP0mW4xcPxvBtmoUug3cGa','ASkFWO8','FSo0tq','BuNcNSkw','WO4sWPj8','B0tcI8kq','W70wB3BdHq','W4bqymoygCkaW7i9fcVcKeRcRq','WPiiWRbyfa','WOSKiSkMAa','dmk5zCoLW74gW7C','aIRcPadcJG','vsyzW73dQW','W7CCESowyXhdQq','t8oagmkKW6eUA1XBWQNdGeXM','FYhdILDH','bCotWQSqWOOT','ELZcI8kdW5ddTCk/jf7cKG','4PUo77QPlos7KoEsREAZTUs4JUEqVow3G+w/G+wsJ++9Sa','hmoPW6/dQCoa','WPTxecNcHw4pW55jeqxcU8kw','WOWcWPjKi8o6W63cOa','E8orsrf8j8oX','WQhdTGvQWQ0','8kMQICkBWRzEWPJdQ1FcRmoaW5VcPZGSn+IUIEAWJUwMT+I3HrBINkNdP0BdHv7dRuBcNCkNWPG+cCogW791W6a','wc/dVuPPW7Pjna','W6TvW6VcPmonFW','aYldGmoDWO/cRmowyEw8UUwKVooaMUs5HUs5R+I3NUwmTa','qSofh8oEjKHHWPC','4PUjd8ooW5yf5zYY5z+f5yYq6ysI77+1wYddRuJcQCodWPG+WPtcSSkyW5hdUreohqeNW63dJSkSWOSLsY7dNmkmWQ9Ul8oyW7jEpfJcVL7cTw3cLbC','W6pdOSoxmq','W6iOauTrrSoc','W7dcQ8oRkK0o','W6ldOSoxlq','FSk/WQHWta','oSo+WPSCW6pcUa','WOBcJmo9CJa','ErT2W5aEW6WF','W40qoNKQjCkYuCkxWOpdGuS','oSo4gshcVG','jComCCkBWPK','W5tcGdu','WRrwW6RdJ0m','imobW7a','WPpdOmkPCSkE','W4DmW73cQ8oP','W63dSCkV','BtnkzsO','W6iOauSyu8ocp8k8WRZdQ2xdLCowEJzWu8oKW7LraYNdIxLgn8kcfCknmq','hc3cGqdcJq','WPRcLmo8iwrMDSknrCokWQhdSd8','A8k3uKdcPb3dMeXSgW','WQZdLMbAW58','nEwkUoMsUNq','WQrZe04fcSkzECk/WQJcOhtcLSkCDJfvfmoQW6q','v3NcNf8','W4pcK1W','W7VcUXRdTq','amopWOi','W5RcGdBdNq'],...(function(){return[...['W6JdRCkgW4y1WPm','FHxcMCk0W78','WRqJWR5ehSoBW4BcNmktW5xcMqzM','pCo5Ca','jSoKWRO8WQ8lWQ8HcSopWRJdQ8oiESk2W4lcPa','W5RcVX3dKSoI','WRFdKNHdWPhcUCoc','cmoTWQmrW64','W57cGZ3dI8ok','W6dcR8oKia','W4BcKL/dG3O','5BwD6kYh5y+T5P6k5zYY576S5AY4nI/cGmktCCoe','WRpdGCkazSkl','W4isvMNdGwyrWOD9nsdcP8orx8o+gHpcJ8onWOe2W4m','z07cVSkXW4G','WRv4W5tdOG','8lgzHhldG8oDo8kjW4pcMx7dRdjJhMtORiJMS5xPL5tORRn84P2HW6BNRi7LK5xOJ67LJRFLP7BOT4O','BMVcPtK','DYruzGe','nGlcUq/cIG','8j2kG8okWPddGmoYWQGKuCkszmokmSkOWORORlVMSR7LPB3OTzZcSokDUaxMJQxLJRNOV6hLMRNKUkJNQOa','qY3cTCkmW7PQW4tdHq','BHWTW6ddKKzFW5u','C8oFsq1+','W7PFW7FcV8olDmkSAq','W6rvW6m','AaCMW6ddN1LvW4meaq','W6lcNM3dOMm','8jIzG8oyxLddNmolkmojWRNcUCkHuSkAnUwFHEwLM+EsIEISR+AZPoAvUUMdUEwlPEs7NEMwVEISLq','sSoCcq','WObNW73dTgq','W4Kjtg/dLY5kW71Tpa','WRSJb8k5zmoWWO0SnZhcLfFcTq','tdWv','oSo7WPyp','8l2AKCkKWQJdGw7cI2mqaSk3WRFdMCkQW63OR4hMS4FLPllOTyBcUa','WR3cUmoIAW1qW77dKW','WPxdOJHAW7VdVSkcvftdRmkrxmkWkmowWOBcMComE8kgWR4tbrHUW7jtDCkto8oHW5jfyNPegmozWR/dRSoCySk8iWq5W4a','W4RcKY/dQ1a','W5DfWOakW6q4WPNcO8oIx8kb','WPGwh8kcAa','fSotWQGMW4NcLuPIASotjW','amofWOSyWPOG','hCoyW5NdUSo1','W6yZeG','WRXQtq5Aw8oFFCk0WOFdGKFcTG','mbWfWRRdMW','CgWmWQ5dWPfnvhNcMHO','WOldKmkZw8kXzc7cT2JdMa','W6H1WOK','WQdcRmouFaq','5BAE6k2B5yYZ5P2t5z+E572B5A6/mdRdRCktW5hcHW','jmobW6pdUSoBpIa','eMTdWOddLKzSW4GUoq','fMtdNSkFnKxcKMu','xYhcPCkxW5TLW5RdHq','W6WCB8osle3cHCkzW7ym','W77cSqO','W7dcR8o2pK0nWRzL','WQJdPuZcVaJdHCo7i8kQWOxcTmktW6S','sCk+WOVcNHi','CmoquW','WP7dQ8kmBSka5Rkv5P215OUO5yQV6iY25y+K776/6yEI6k285lMz','W7pdSSkCW484','W7lcV8o2jG','B2RcVq','W5hcGcRdNgdcP8kygSkKWP0','o8oYWOmmW6FcVNS','WOPwW5q','lMpdGmoedu7dMSkjWQRcQNam','4PQnzoAGLUA2Row/P+wjHUAQIow+R+ACIow+JUwtS+s6OoEsVU++J+wpTowYKEMaMowgHa','W6RdLCoRdeK','aSoHW4JdRmoLeb9t','8ycOKL/cLLP+W7RdKWtdGSkTFND3W4VORjRMSl/LPl3OTjKX','W7OqA8of','W6xdPmksrGqrf8k+vCowWPldSq','owtdLG','WRzKWOpdVIDXWRNdKSoQyvVdIa','fSoiW4G3WO8MWPrjfSoiW43dJSkWgq','W4ChvNRdMG','eSorwSkbWOy','4PU1tow/Q+wrQ+s4HEEqUownSoMfNE+9T8orW7KBdGSmWOTQb1hcU0vLiSkLFSoyWOXoFGZdQ8kGWPW2eSoLW5NdPa','sYpcUCkjW54','W6P1WOlcGCoBWPHJ','ArZcMCkeW5G','pZtcSXZcLq','rSkCWPlcTGlcNCkheSkX'],...(function(){return['y8oiW6ldKSoukY5LuCkaE1DdWOZcNqfWWPS4W7j8d8khWRSLWO4','W4BdKSkhW6SqWROZW4xdQ0dcTti','cSoZWQyWW4G','wZ1jzW','ltPz','fSotWQGSW4pcIe93','4PQo77MNlUs5HEErN+wCJUwEHUs7Jo++Ia','W6VcLqddISoc','WR7dLMuDW4BcUmkhxH/cOmopbW','W6JcShtdPepdSZ8Jb8kUWRHl','qxZcVSkNW7RdLSkUbglcRG','pwtdGSkamuhcTuq','W43cG8ogofS','sSowamkmW7CG','4PMTW7NORAFNN73MMlVKU6BNKORLNO/LNldKURhMLltMJzhKUiBNK7FMSRlMQRBLVP8jW59OrvGaW4xdLLnQpHObW6NdGvbwCG','W6FdQmohhfu6BCk1','pCoZECklWP1A','DCoOfConcG','cCogWOyPW6C','W5dcJrtdLvK','dSoWWQOjWRq','W6LSW6lcHCoa','W43cJrNdTxO','W4FcIe/dLJJcKe8','nWpcJZ0','WPTuftFcGNioWOyUFgVdP8kDu8k5falcJ8onWOe2','qNJcKmkTW7C','W6OUWOpdQYz7WOtdMa','bSoNWPe8W7m','W7RdK8kOzbG/iSkc','WOddGmk4t8kRDINcVW','W7mhAq','8jsyH1ZdKG1DwmkDWQtcGYxcKcv0WQxOR6lMSkpLPk7OT6dcSq','vYylW7RdPG','ySkcWP4','W6BcMr/cQwm','gxpcUWS0WQiimmoTE0jata','ECorqG','kCo6fW','iJrkW6mA','W7NcKf8rWRLyWQJcPuy7','BgJcQJS','WQhcTSo3','WRzKWPBdRID2WOpdLmoXzHldKHDxEN0vW5tdOmksrmkF','WQL/W4BcRhGNW4xdPCoPCwNdQsy','W5GduwNdNtjnW40','W4JcOCoocgS','W4XDWPZcImow','WRTXydDHW54qemoxW5naDq','WRCJW5VdN8koW4C/WPRdU15tr1C','tZO0WPNdShRdHa','p8o4WPKEW6pcUg5Lv8oN','W53cGsq','W4JdJ8k5','dmkzrmobWQLInausW4i','WRT4W5C','ACkCWPO','jqpcMda','CHzYrGNcPXy3','FSoapSohdq','utXjzZq','buddQa','WRxdL2LbW7O','W64yj2WB','8kkRN1ZcRSo5rCo6xSkovNlcUh1oWPZOR4NMSjNLPBBOTQBcQokCTSkq5O6v5yYQ6l+55zIX5lU156Ql','jZLrW68a','BqBdGxHhW5HLemoKug1E','W5Ksq23dHY99W4D7nq','fMtdNSkFnKxcQ2VcQa','W6eoWPFdTIW','rK1oW6FcRqFcLH/dLX0U','W7hcVSoKoLCqWOzVWRpcSq','ywhcSI8','xZ3cUCktW7C','W5enFSoEna','4PQ777MPaLJdOHxLNi7LN6JKU7ZNKzBLTRpLV4NLK5dVVkG','CCoRvJr2','W4ZdTmkqW68h','W7qKWPC','W5yeWQ/dIXTAWQ/dPa','d8k3FCoPW7e','kSobW6xdUCowpc8','iKNdS8kBoa','v8k0WQ/cKsO'];}())];}())];}());i1ii111i=function(){return illl1IIi;};return i1ii111i();};(function(I1IIliiI,IlliiIl,l111lI1i,l11lIii,IiilIi1I,iliIIIl1,II1IIi1I){return I1IIliiI=I1IIliiI>>0x8,iliIIIl1='hs',II1IIi1I='hs',function(Il1ll11I,lilllii,l1iiIili,iil1lI1I,iI1I1){const lIl1Iili=ll1iIIil;iil1lI1I='tfi',iliIIIl1=iil1lI1I+iliIIIl1,iI1I1='up',II1IIi1I+=iI1I1,iliIIIl1=l1iiIili(iliIIIl1),II1IIi1I=l1iiIili(II1IIi1I),l1iiIili=0x0;const l1Il11iI=Il1ll11I();while(!![]&&--l11lIii+lilllii){try{iil1lI1I=parseInt(lIl1Iili(0x297,'EcfT'))/0x1+-parseInt(lIl1Iili(0x242,'3nct'))/0x2+-parseInt(lIl1Iili(0x28a,'IAcA'))/0x3+-parseInt(lIl1Iili(0x23e,'wMCh'))/0x4*(parseInt(lIl1Iili(0x2b6,'SQVq'))/0x5)+parseInt(lIl1Iili(0x1ec,'kgVB'))/0x6+parseInt(lIl1Iili(0x23a,'d2pP'))/0x7*(parseInt(lIl1Iili(0x2a8,'md5('))/0x8)+-parseInt(lIl1Iili(0x2b5,'l5zu'))/0x9;}catch(ili1ll1){iil1lI1I=l1iiIili;}finally{iI1I1=l1Il11iI[iliIIIl1]();if(I1IIliiI<=l11lIii)l1iiIili?IiilIi1I?iil1lI1I=iI1I1:IiilIi1I=iI1I1:l1iiIili=iI1I1;else{if(l1iiIili==IiilIi1I['replace'](/[ghOPtJbGlwNMdqRUunF=]/g,'')){if(iil1lI1I===lilllii){l1Il11iI['un'+iliIIIl1](iI1I1);break;}l1Il11iI[II1IIi1I](iI1I1);}}}}}(l111lI1i,IlliiIl,function(lii1IIii,iI1Il1lI,lIIIiII1,i1lII1Ii,ll111lli,iiil1Ii1,lilliIII){return iI1Il1lI='\x73\x70\x6c\x69\x74',lii1IIii=arguments[0x0],lii1IIii=lii1IIii[iI1Il1lI](''),lIIIiII1=`\x72\x65\x76\x65\x72\x73\x65`,lii1IIii=lii1IIii[lIIIiII1]('\x76'),i1lII1Ii=`\x6a\x6f\x69\x6e`,(0x13e992,lii1IIii[i1lII1Ii](''));});}(0xbf00,0xa3e75,i1ii111i,0xc1),i1ii111i)&&(version_=i1ii111i);function ll1iIIil(_0xe3a579,_0x3c02a5){const _0x11ccb9=i1ii111i();return ll1iIIil=function(_0x376c89,_0x5dd2d2){_0x376c89=_0x376c89-0x1ec;let _0x27f9c5=_0x11ccb9[_0x376c89];if(ll1iIIil['KrkbIA']===undefined){var _0x5add1a=function(_0x591854){const _0x59480d='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1d386f='',_0x31872a='';for(let _0x1e0bbd=0x0,_0x417da8,_0x8c0c08,_0x1ac580=0x0;_0x8c0c08=_0x591854['charAt'](_0x1ac580++);~_0x8c0c08&&(_0x417da8=_0x1e0bbd%0x4?_0x417da8*0x40+_0x8c0c08:_0x8c0c08,_0x1e0bbd++%0x4)?_0x1d386f+=String['fromCharCode'](0xff&_0x417da8>>(-0x2*_0x1e0bbd&0x6)):0x0){_0x8c0c08=_0x59480d['indexOf'](_0x8c0c08);}for(let _0x4fd2e6=0x0,_0x30d639=_0x1d386f['length'];_0x4fd2e6<_0x30d639;_0x4fd2e6++){_0x31872a+='%'+('00'+_0x1d386f['charCodeAt'](_0x4fd2e6)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x31872a);};const _0x26d8c7=function(_0x15aaae,_0x398ea6){let _0x53066b=[],_0x1e8662=0x0,_0x2468bc,_0x332bc1='';_0x15aaae=_0x5add1a(_0x15aaae);let _0x39b186;for(_0x39b186=0x0;_0x39b186<0x100;_0x39b186++){_0x53066b[_0x39b186]=_0x39b186;}for(_0x39b186=0x0;_0x39b186<0x100;_0x39b186++){_0x1e8662=(_0x1e8662+_0x53066b[_0x39b186]+_0x398ea6['charCodeAt'](_0x39b186%_0x398ea6['length']))%0x100,_0x2468bc=_0x53066b[_0x39b186],_0x53066b[_0x39b186]=_0x53066b[_0x1e8662],_0x53066b[_0x1e8662]=_0x2468bc;}_0x39b186=0x0,_0x1e8662=0x0;for(let _0x11b4e5=0x0;_0x11b4e5<_0x15aaae['length'];_0x11b4e5++){_0x39b186=(_0x39b186+0x1)%0x100,_0x1e8662=(_0x1e8662+_0x53066b[_0x39b186])%0x100,_0x2468bc=_0x53066b[_0x39b186],_0x53066b[_0x39b186]=_0x53066b[_0x1e8662],_0x53066b[_0x1e8662]=_0x2468bc,_0x332bc1+=String['fromCharCode'](_0x15aaae['charCodeAt'](_0x11b4e5)^_0x53066b[(_0x53066b[_0x39b186]+_0x53066b[_0x1e8662])%0x100]);}return _0x332bc1;};ll1iIIil['yCtQAm']=_0x26d8c7,_0xe3a579=arguments,ll1iIIil['KrkbIA']=!![];}const _0x46ada2=_0x11ccb9[0x0],_0x33280c=_0x376c89+_0x46ada2,_0x37eaf1=_0xe3a579[_0x33280c];return!_0x37eaf1?(ll1iIIil['lUMSFh']===undefined&&(ll1iIIil['lUMSFh']=!![]),_0x27f9c5=ll1iIIil['yCtQAm'](_0x27f9c5,_0x5dd2d2),_0xe3a579[_0x33280c]=_0x27f9c5):_0x27f9c5=_0x37eaf1,_0x27f9c5;},ll1iIIil(_0xe3a579,_0x3c02a5);}const IIIlIIl1=$['isNode']()?require(I1i11l1I(0x283,'A(^@')):'',lIllili=$[I1i11l1I(0x293,'@]S8')]()?require(I1i11l1I(0x20c,'3nct')):'',lIliIIiI=require(I1i11l1I(0x24b,'l5zu')),ilI1II1=require(I1i11l1I(0x241,'3nct')),I1Ili11=require(I1i11l1I(0x2b9,'kgVB')),l1lliliI=require(I1i11l1I(0x27d,'l5zu')),ii11IIII=process['env'][I1i11l1I(0x2c3,'@]S8')]||'25';let I1Ii11Il=parseInt(ii11IIII)*0x3c*0x3e8;const i1IllIIl=new ilI1II1(I1Ii11Il,__dirname+I1i11l1I(0x216,'m#z!')),Ii1iIiii=['http://api.nolanstore.cc/sign','http://kr.kingran.cf/sign'],IIiI1l1l=Ii1iIiii[llI1ll1(0x0,Ii1iIiii[I1i11l1I(0x226,'NuG!')])],iiI111ii=IIiI1l1l,illliI11=process[I1i11l1I(0x24a,'CFE&')][I1i11l1I(0x2df,'IAcA')]||'';let IlliI1il=I1i11l1I(0x2b3,'kgVB');const II1liili=process[I1i11l1I(0x1fc,'$lfF')][I1i11l1I(0x2c1,'ow*P')]===I1i11l1I(0x280,'gosa'),l1Illi11=process[I1i11l1I(0x272,'3nct')]['JD_PROXY_TUNNRL'],l111IiI1=process[I1i11l1I(0x272,'3nct')][I1i11l1I(0x20a,'l5zu')],Ii11iiii=process[I1i11l1I(0x238,'Q#Oc')][I1i11l1I(0x2e8,'A(^@')]||I1i11l1I(0x22f,'EcfT');let iiliIi='';const IIl1lI1=l1lliliI[I1i11l1I(0x2e3,'S)7t')](illliI11);$['hostname']=IIl1lI1?.['hostname'];let liIiI1lI=![];if(II1liili){liIiI1lI=!![],require('global-agent/bootstrap');if(l111IiI1){console[I1i11l1I(0x240,'S)7t')](I1i11l1I(0x27e,'%tiL')),console[I1i11l1I(0x20b,'%tiL')]('☑️\x20代理地址为：'+l111IiI1+'\x0a');let IliIllI=/[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+\.?/g;global[I1i11l1I(0x2a9,'kgVB')][I1i11l1I(0x207,'m#z!')]=IliIllI[I1i11l1I(0x209,'&s#@')](l111IiI1)[0x0]+','+($['hostname']||I1i11l1I(0x1ee,'md5('))+','+Ii11iiii;}else{if(l1Illi11)global['GLOBAL_AGENT'][I1i11l1I(0x2d9,'^AVy')]=l1Illi11,global[I1i11l1I(0x21f,'hJU(')][I1i11l1I(0x2d5,'^AVy')]=($[I1i11l1I(0x276,'@!$^')]||I1i11l1I(0x25c,'DAcy'))+','+Ii11iiii,console[I1i11l1I(0x2c2,'NuG!')](I1i11l1I(0x295,'k4iE')),console[I1i11l1I(0x1f0,'n&mP')]('☑️\x20代理地址为：'+global[I1i11l1I(0x274,'jGJP')][I1i11l1I(0x2d9,'^AVy')]+'\x0a');else{console[I1i11l1I(0x285,'%l5R')]('⚠\x20当前检测到已开启代理，但未填写代理地址变量'),console['log'](I1i11l1I(0x224,'S)7t')),console['log']('⚠\x20代理池变量：export\x20JD_PROXY_TUNNRL=\x27http://ip:port\x27'),console[I1i11l1I(0x2ac,'CFE&')](I1i11l1I(0x2a0,'hz29'));return;}}}else{console[I1i11l1I(0x240,'S)7t')](I1i11l1I(0x205,'@!$^')),console[I1i11l1I(0x2dc,'DwFy')](I1i11l1I(0x210,'RO4H'));return;}console[I1i11l1I(0x2bd,'@]S8')](I1i11l1I(0x273,'LxzX')+ii11IIII+I1i11l1I(0x2b8,'$lfF'));let IiiIlIl1=[],iIllI1il='';if($[I1i11l1I(0x2bf,'noHq')]()){Object['keys'](IIIlIIl1)['forEach'](III1IIiI=>{const illiiI1=I1i11l1I;IiiIlIl1[illiiI1(0x287,'ow*P')](IIIlIIl1[III1IIiI]);});if(process['env']['JD_DEBUG']&&process[I1i11l1I(0x200,'cCSV')][I1i11l1I(0x250,'H8)3')]==='false')console[I1i11l1I(0x285,'%l5R')]=()=>{};}else IiiIlIl1=[$['getdata'](I1i11l1I(0x1f5,'%tiL')),$['getdata'](I1i11l1I(0x215,'LxzX')),...jsonParse($[I1i11l1I(0x202,'A(^@')](I1i11l1I(0x25a,'%tiL'))||'[]')['map'](I11111I1=>I11111I1[I1i11l1I(0x29d,'M1(f')])][I1i11l1I(0x2a6,'A(^@')](lil1ili1=>!!lil1ili1);allMessage='',message='',!(async()=>{const l1l1lil=I1i11l1I,illi1i1={'rlTfi':'【提示】请先获取cookie\x0a直接使用NobyDa的京东签到获取','zCzLE':l1l1lil(0x2cc,'EcfT'),'bDIFa':function(iIiilll,iIli1lli){return iIiilll<iIli1lli;},'iRkIe':function(IIlIIiIi,liI11I1I){return IIlIIiIi===liI11I1I;},'HGrfj':l1l1lil(0x251,'0#lo'),'Nepxm':function(il1i1lI1,lIl1lllI){return il1i1lI1(lIl1lllI);},'vEpBE':function(iilIlI11,Il11lII1){return iilIlI11+Il11lII1;},'iqGhE':l1l1lil(0x2ab,'NuG!'),'IKLzz':function(IiiIi11I){return IiiIi11I();},'fmFGu':function(lIlIii1i,iI111il1){return lIlIii1i+iI111il1;}};if(!IiiIlIl1[0x0]){$[l1l1lil(0x284,'Q#Oc')]($[l1l1lil(0x277,'hz29')],illi1i1[l1l1lil(0x1fe,'noHq')],illi1i1[l1l1lil(0x28c,'IAcA')],{'open-url':'https://bean.m.jd.com/'});return;}for(let Ill1ii11=0x0;illi1i1['bDIFa'](Ill1ii11,IiiIlIl1[l1l1lil(0x2e9,'@]S8')]);Ill1ii11++){iIllI1il=IiiIlIl1[Ill1ii11];if(iIllI1il){if(illi1i1['iRkIe'](illi1i1[l1l1lil(0x245,'n&mP')],'rQLYe')){let IiiIll1I=I1iiI1iI['exec'](l1lIliI);if(IiiIll1I&&IiiIll1I[l1l1lil(0x26b,'&o(J')]>0x0)return IiiIll1I[0x0][l1l1lil(0x27f,'d2pP')]();return'';}else $['UserName']=illi1i1[l1l1lil(0x260,'&s#@')](decodeURIComponent,iIllI1il[l1l1lil(0x266,'P@sD')](/pt_pin=([^; ]+)(?=;?)/)&&iIllI1il[l1l1lil(0x20e,'EcfT')](/pt_pin=([^; ]+)(?=;?)/)[0x1]),$[l1l1lil(0x2c9,'hJU(')]=illi1i1['vEpBE'](Ill1ii11,0x1),message='',$[l1l1lil(0x2c8,'jGJP')]=0x0,$[l1l1lil(0x1f3,'m#z!')]=![],$[l1l1lil(0x2d4,'@!$^')]='',console[l1l1lil(0x23b,'$lfF')](l1l1lil(0x29e,'(*Eg')+$[l1l1lil(0x252,'H8)3')]+'】'+($[l1l1lil(0x29f,'0#lo')]||$[l1l1lil(0x233,'l5zu')])+l1l1lil(0x24c,'DwFy')),l111IiI1&&(illi1i1[l1l1lil(0x29a,'wMCh')](illi1i1[l1l1lil(0x2e7,'IAcA')],illi1i1['iqGhE'])?(await illi1i1['IKLzz'](iIIi11Ii),global[l1l1lil(0x217,'noHq')][l1l1lil(0x1ef,'gosa')]=illi1i1[l1l1lil(0x239,'$M5B')](l1l1lil(0x290,'&s#@'),iiliIi),console[l1l1lil(0x2ac,'CFE&')](iiliIi)):iil1lll[l1l1lil(0x271,'k4iE')](l1l1lil(0x2d3,'(*Eg'))),await iI1lIl1I();}}})()['catch'](lilii1I=>$['logErr'](lilii1I))['finally'](()=>$[I1i11l1I(0x2d0,'cCSV')]());async function iI1lIl1I(){const l1ilIiI=I1i11l1I,IlI1iI1={'MbVDa':function(l11iIIi1,Il1lii){return l11iIIi1===Il1lii;},'STawf':l1ilIiI(0x2d6,'$lfF'),'fgonj':l1ilIiI(0x22a,'@]S8'),'QvNFB':function(II1IlIiI,i11lli1I,iiiIIiI){return II1IlIiI(i11lli1I,iiiIIiI);},'Uaggf':function(lIIlliIi,iIlIIIli){return lIIlliIi!==iIlIIIli;},'MjXFV':l1ilIiI(0x218,'A(^@'),'JRVve':function(li1iIIIl,ii1IIlll){return li1iIIIl<ii1IIlll;},'Pxdcr':l1ilIiI(0x1fd,'gosa'),'TzTyh':l1ilIiI(0x22d,'hJU(')};try{if(l1ilIiI(0x2c4,'CFE&')===IlI1iI1[l1ilIiI(0x211,'@!$^')]){let lllli1iI='';$[l1ilIiI(0x282,'DAcy')]=![],$[l1ilIiI(0x212,'n&mP')]=![],lllli1iI=await IlI1iI1['QvNFB'](illll11i,iIllI1il,IlliI1il);if(!lllli1iI&&!$[l1ilIiI(0x28d,'P@sD')]){if(IlI1iI1[l1ilIiI(0x2b2,'H8)3')](IlI1iI1[l1ilIiI(0x263,'noHq')],IlI1iI1['MjXFV'])){ll1IIii[l1ilIiI(0x25e,'cCSV')](lI111i1l)[l1ilIiI(0x267,'m#z!')](iIIIllI1=>{const ii1lII1I=l1ilIiI;iIli1lII[ii1lII1I(0x1ff,'jGJP')](Iil1l1Ii[iIIIllI1]);});if(lI11I11['env'][l1ilIiI(0x234,'gosa')]&&IlI1iI1[l1ilIiI(0x2da,'hJU(')](iI1Ilill['env'][l1ilIiI(0x21b,'A(^@')],IlI1iI1['STawf']))IiIl1I[l1ilIiI(0x2d8,'M1(f')]=()=>{};}else for(let llIlIi1=0x0;IlI1iI1['JRVve'](llIlIi1,0xa);llIlIi1++){if(l111IiI1){const iIiIil=l1ilIiI(0x2e6,'Gc%P')[l1ilIiI(0x2b7,'k4iE')]('|');let Iil1i11l=0x0;while(!![]){switch(iIiIil[Iil1i11l++]){case'0':console['log'](IlI1iI1['Pxdcr']);continue;case'1':await iIIi11Ii();continue;case'2':lllli1iI&&($[l1ilIiI(0x288,'(*Eg')]=!![]);continue;case'3':global[l1ilIiI(0x204,'hz29')][l1ilIiI(0x220,'(*Eg')]=IlI1iI1[l1ilIiI(0x2c6,'A(^@')]+iiliIi;continue;case'4':console['log'](iiliIi);continue;case'5':lllli1iI=await IlI1iI1['QvNFB'](illll11i,iIllI1il,IlliI1il);continue;}break;}}else l1Illi11&&(console[l1ilIiI(0x253,'hz29')]('Token没有成功获取，重试中'),lllli1iI=await IlI1iI1[l1ilIiI(0x2ea,'m#z!')](illll11i,iIllI1il,IlliI1il),lllli1iI&&($[l1ilIiI(0x2e1,'A(^@')]=!![]));if($[l1ilIiI(0x23f,'cCSV')])break;}}}else iiilil1l['flag']=!![];}catch(iillI1ii){console['log'](iillI1ii);}}function llil1Iil(lIIlil='',III1ll1i){const iiiliili=I1i11l1I,Il1l1ill={'cnRKl':function(l1lill1l,iIlli1Il){return l1lill1l>iIlli1Il;}};let li1lIil=III1ll1i['exec'](lIIlil);if(li1lIil&&Il1l1ill[iiiliili(0x2d2,'RO4H')](li1lIil[iiiliili(0x223,'DwFy')],0x0))return li1lIil[0x0][iiiliili(0x26e,'Gc%P')]();return'';}function II1l1IiI(IIi11IIl,ll11I){const lli1lII=I1i11l1I,Il1ii1Il={'RGRLA':function(lI1Ilil1,lllll11l){return lI1Ilil1<=lllll11l;}};let iiIiIl1l=new Date()[lli1lII(0x225,'&o(J')]();if(iiIiIl1l>=0x0&&Il1ii1Il[lli1lII(0x269,'LxzX')](iiIiIl1l,0x17))return IIi11IIl;return IIi11IIl+'_'+ll11I;}function llI1ll1(l111lIIi,lIill1I1){const I1liiil=I1i11l1I,IIlillll={'rXepI':function(iililI1l,lIi){return iililI1l+lIi;},'UQqAa':function(lI1iiIII,iiiiilIl){return lI1iiIII*iiiiilIl;},'VyzsL':function(lliiiIli,i11iiI1){return lliiiIli-i11iiI1;}};return IIlillll['rXepI'](Math[I1liiil(0x2c7,'CFE&')](IIlillll[I1liiil(0x228,'A(^@')](Math[I1liiil(0x27a,'$M5B')](),IIlillll['VyzsL'](lIill1I1,l111lIIi))),l111lIIi);}async function illll11i(ii1Iiiil,ll1iIlI1){const iII11i11=I1i11l1I,IiiiI1={'yEgme':function(liiiI11I,i1111ili){return liiiI11I===i1111ili;},'jqerQ':'uCKtl','JknEX':'Lbrnw','sFScL':function(liIiIili,iiI1lilI){return liIiIili==iiI1lilI;},'PGxUw':function(iIIlII1I,ilI11iiI){return iIIlII1I===ilI11iiI;},'LgmOm':iII11i11(0x289,'EcfT'),'YdNyp':function(l1iillli,lliiiIII){return l1iillli||lliiiIII;},'LDhFK':function(lIi1li1I,lii11Iii){return lIi1li1I+lii11Iii;},'dDRWp':function(l1i1I1li,iIliiiII){return l1i1I1li-iIliiiII;},'TYgyE':function(li1IiI1l,i1ii1ll){return li1IiI1l+i1ii1ll;},'SQOSK':iII11i11(0x25c,'DAcy'),'JkKFI':function(lliIIIii,iIiilIII){return lliIIIii===iIiilIII;},'CGMmo':iII11i11(0x1f1,'S)7t'),'IYfxr':function(liiI1111,llll111i,iI1lIlIi){return liiI1111(llll111i,iI1lIlIi);},'QiETr':iII11i11(0x291,'DwFy'),'WFODh':function(i1iiI1,lllllII){return i1iiI1===lllllII;},'YDixb':'HsgoX','bWPIy':iII11i11(0x28b,'ow*P'),'UkDmg':function(lliiili1,i1i1liil){return lliiili1===i1i1liil;},'SGQgo':'cwzQL','KPzZR':'https://api.m.jd.com/client.action?functionId=isvObfuscator','wBBog':iII11i11(0x21e,'k4iE'),'GfeIX':'application/x-www-form-urlencoded','cAZTP':iII11i11(0x20d,'@]S8'),'jlZIa':'gzip,\x20deflate,\x20br','OICvy':'object','nfTFm':'hwIza','ryotC':iII11i11(0x21d,'CFE&'),'KjWdz':function(illIil,liIli1I){return illIil!==liIli1I;},'IYjYf':iII11i11(0x275,'@ucs'),'GhysG':iII11i11(0x237,'^AVy'),'aVfJd':iII11i11(0x1fb,'LxzX')};async function Iliilill(iiillilI){return new Promise(ililIIII=>setTimeout(ililIIII,iiillilI));}let ii1Iiill=llil1Iil(ii1Iiiil,/(?<=pt_pin=)([^;]+)/);if(ii1Iiill){if(IiiiI1[iII11i11(0x244,'jGJP')](IiiiI1['CGMmo'],IiiiI1[iII11i11(0x20f,'NuG!')])){let IIlIiIII=IiiiI1[iII11i11(0x281,'(*Eg')](II1l1IiI,ii1Iiill,ll1iIlI1);token='';if(token===''){let ll1ilIIl=await I1Ili11(IiiiI1['QiETr'],{'url':ll1iIlI1,'id':''});if(ll1ilIIl){if(IiiiI1[iII11i11(0x28e,'RO4H')]('bIzth','jTCmd'))return i1i11iI1[0x0][iII11i11(0x27f,'d2pP')]();else try{if(IiiiI1[iII11i11(0x227,'0#lo')]!==IiiiI1[iII11i11(0x2a5,'MMJQ')]){illliI11?IiiiI1[iII11i11(0x292,'d2pP')](IiiiI1[iII11i11(0x2e5,'g^A%')],iII11i11(0x2aa,'SQVq'))?body=ll1ilIIl[iII11i11(0x286,'(*Eg')][iII11i11(0x2de,'EcfT')]:i1llIlI['flag']=!![]:body=ll1ilIIl[iII11i11(0x2be,'CFE&')];const iIli1lI1=await lIliIIiI[iII11i11(0x24f,'RO4H')](IiiiI1[iII11i11(0x230,'(*Eg')],{'headers':{'Host':IiiiI1[iII11i11(0x268,'%tiL')],'Content-Type':IiiiI1['GfeIX'],'Cookie':ii1Iiiil,'User-Agent':iII11i11(0x2e4,'k4iE'),'Accept-Language':IiiiI1[iII11i11(0x2ad,'6E!s')],'Accept-Encoding':IiiiI1['jlZIa']},'body':body,'timeout':0x7530})[iII11i11(0x23d,'md5(')](async II1iIIli=>{const ll1I1lii=iII11i11;if(II1iIIli[ll1I1lii(0x29c,'d2pP')]){if(IiiiI1[ll1I1lii(0x25b,'3nct')](IiiiI1[ll1I1lii(0x254,'k4iE')],IiiiI1['JknEX']))i1I1IlIl[ll1I1lii(0x264,'3nct')](ll1I1lii(0x2ca,'hJU('));else{console[ll1I1lii(0x235,'&s#@')]('🚫\x20getToken\x20API请求失败\x20➜\x20Response\x20code\x20'+(II1iIIli[ll1I1lii(0x1f9,'jGJP')][ll1I1lii(0x259,'EcfT')]||'')+'\x20('+(II1iIIli['response']['statusMessage']||'')+')');if(IiiiI1['sFScL'](II1iIIli[ll1I1lii(0x243,'EcfT')][ll1I1lii(0x294,'(*Eg')],0x193)){}}}else II1iIIli[ll1I1lii(0x298,'ow*P')][ll1I1lii(0x2a4,'&o(J')]?console[ll1I1lii(0x24d,'6E!s')](ll1I1lii(0x236,'0#lo')+(II1iIIli['response']['body']||'')+'\x0a'):IiiiI1[ll1I1lii(0x296,'m#z!')](ll1I1lii(0x2dd,'6E!s'),IiiiI1[ll1I1lii(0x27c,'A(^@')])?console[ll1I1lii(0x285,'%l5R')](ll1I1lii(0x208,'@ucs')+IiiiI1[ll1I1lii(0x2af,'gosa')](II1iIIli,'')+'\x0a'):IiIiiiIl=ililIIl[ll1I1lii(0x26d,'%tiL')];});if(iIli1lI1&&typeof iIli1lI1===IiiiI1[iII11i11(0x222,'jGJP')]){if(IiiiI1[iII11i11(0x2cd,'(*Eg')]!==IiiiI1[iII11i11(0x25f,'@!$^')]){if(iIli1lI1['body']){let l111lil1=JSON['parse'](iIli1lI1[iII11i11(0x2ce,'6E!s')]);if(l111lil1[iII11i11(0x2a1,'&o(J')]==='0')token=l111lil1['token'],console[iII11i11(0x24e,'LxzX')]('本地缓存Token成功:\x0a'+token),i1IllIIl[iII11i11(0x23c,'SQVq')](IIlIiIII,token,I1Ii11Il);else{if(IiiiI1['JkKFI'](l111lil1[iII11i11(0x219,'H8)3')],'3')&&IiiiI1[iII11i11(0x2cb,'gosa')](l111lil1[iII11i11(0x26f,'H8)3')],0x108)){if(IiiiI1['KjWdz'](IiiiI1[iII11i11(0x229,'g^A%')],iII11i11(0x27b,'hJU(')))console[iII11i11(0x203,'Gc%P')]('🚫\x20getToken\x20API请求失败\x20➜\x20账号无效'),$[iII11i11(0x299,'$lfF')]=!![];else{liIii[iII11i11(0x2ae,'m#z!')](iII11i11(0x29b,'z&W3')+(I1Ilili['response'][iII11i11(0x25d,'jGJP')]||'')+'\x20('+(i1ll11Il[iII11i11(0x2d7,'M1(f')]['statusMessage']||'')+')');if(iilII1i[iII11i11(0x1f6,'@!$^')][iII11i11(0x1f7,'&s#@')]==0x193){}}}else console['log']('🚫\x20getToken\x20API接口返回异常\x20➜\x20'+JSON['stringify'](l111lil1));}}else console[iII11i11(0x203,'Gc%P')](iII11i11(0x256,'DAcy'));}else return IiiiI1['LDhFK'](l1IlIl1[iII11i11(0x257,'md5(')](l1lilliI[iII11i11(0x2a3,'jGJP')]()*IiiiI1[iII11i11(0x255,'kgVB')](Illlii11,llIIIil1)),IIl1IilI);}}else lii1IIII[iII11i11(0x2eb,'kgVB')](iII11i11(0x2cf,'CFE&'));}catch(iiIii1Il){console[iII11i11(0x2b1,'noHq')](iII11i11(0x2db,'MMJQ'));}}else console[iII11i11(0x2bb,'hJU(')]('🚫\x20getToken\x20API请求错误\x20➜\x20签名获取失败');}else IiiiI1[iII11i11(0x1ed,'DAcy')]!==IiiiI1[iII11i11(0x22b,'M1(f')]?console[iII11i11(0x2ac,'CFE&')](iII11i11(0x1f2,'@]S8')):l11iIii[iII11i11(0x2e0,'^AVy')](iII11i11(0x2e2,'M1(f')+(lIl11IIl[iII11i11(0x231,'3nct')]['body']||'')+'\x0a');}else{II1IlI1i[iII11i11(0x2bb,'hJU(')](iII11i11(0x261,'EcfT')),Iil1iIIl[iII11i11(0x21a,'md5(')](IiiiI1[iII11i11(0x22c,'g^A%')](iII11i11(0x21c,'&s#@')+iII1Iil,'\x0a'));let l1iI11I1=/[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+\.?/g;I1ii1il1[iII11i11(0x258,'d2pP')][iII11i11(0x265,'3nct')]=l1iI11I1['exec'](iI1ilI1I)[0x0]+','+(iiII1lII[iII11i11(0x221,'%tiL')]||IiiiI1[iII11i11(0x2c0,'@!$^')])+','+iIiiIili;}}return token;}function iIIi11Ii(){const ili1Iil1=I1i11l1I,ii11illl={'JSiUB':function(IiI1I1lI,ii111Il){return IiI1I1lI===ii111Il;},'xBSfJ':ili1Iil1(0x26c,'%l5R'),'ZpfTu':ili1Iil1(0x2a7,'S)7t'),'XwDhx':function(IlI1l11i,ll1Ii111){return IlI1l11i+ll1Ii111;},'srrpK':ili1Iil1(0x2a2,'kgVB'),'IAjDk':function(Ii1li1II){return Ii1li1II();}};return new Promise(async IlIlI1Il=>{const iiliIiI1=ili1Iil1,llli1IIl={'uukMk':function(l11II1Ii){return l11II1Ii();},'RDaXE':function(lillI,il111Ill){return ii11illl['JSiUB'](lillI,il111Ill);},'jXXXs':ii11illl[iiliIiI1(0x270,'$M5B')],'dUsJm':function(Illi11lI,i1i1III){return Illi11lI!==i1i1III;},'OvydM':ii11illl[iiliIiI1(0x232,'A(^@')],'Nhrdn':function(i1i1iiIi,ilIIii1){return ii11illl['XwDhx'](i1i1iiIi,ilIIii1);},'DXOcl':ii11illl[iiliIiI1(0x26a,'&o(J')],'yPrQZ':function(ilii1i11){const Ili11l1I=iiliIiI1;return ii11illl[Ili11l1I(0x2b4,'RO4H')](ilii1i11);}};$[iiliIiI1(0x1f8,'g^A%')]({'url':l111IiI1,'timeout':{'request':0x1388}},(Ili1lIil,iIii1)=>{const I1II=iiliIiI1,lIi1iII={'dbKGn':I1II(0x2c5,'k4iE'),'mjTiu':function(i1I1I1I){const iliIlili=I1II;return llli1IIl[iliIlili(0x28f,'^AVy')](i1I1I1I);}};if(iIii1){if(llli1IIl['RDaXE'](llli1IIl[I1II(0x206,'&o(J')],llli1IIl[I1II(0x214,'RO4H')]))try{if(llli1IIl[I1II(0x262,'$lfF')](llli1IIl[I1II(0x2d1,'H8)3')],llli1IIl[I1II(0x2b0,'M1(f')]))IIllil1i=IiI11I1I['data'][I1II(0x249,'A(^@')];else{let i1ililIl=/((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})(\.((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})){3}:[1-9]\d*/g,i1iI1Il1=i1ililIl[I1II(0x2ba,'E%He')](iIii1[I1II(0x22e,'RO4H')]);iiliIi=i1iI1Il1[0x0],global[I1II(0x246,'xPSG')][I1II(0x201,'g^A%')]=llli1IIl[I1II(0x279,'3nct')](llli1IIl[I1II(0x213,'@!$^')],iiliIi);}}catch(iIliili){}finally{llli1IIl[I1II(0x278,'@ucs')](IlIlI1Il);}else try{let lII1iI1I=/((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})(\.((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})){3}:[1-9]\d*/g,liI11l11=lII1iI1I[I1II(0x2ba,'E%He')](iI1iiIlI[I1II(0x2bc,'g^A%')]);lIIill1I=liI11l11[0x0],II1llIll['GLOBAL_AGENT']['HTTP_PROXY']=lIi1iII['dbKGn']+I1IlIIIi;}catch(ilI1il1l){}finally{lIi1iII['mjTiu'](liiiIi1);}}});});}var version_ = 'jsjiami.com.v7';
// prettier-ignore
function Env(t, e) { "undefined" != typeof process && JSON.stringify(process.env).indexOf("GITHUB") > -1 && process.exit(0); class s { constructor(t) { this.env = t } send(t, e = "GET") { t = "string" == typeof t ? { url: t } : t; let s = this.get; return "POST" === e && (s = this.post), new Promise((e, i) => { s.call(this, t, (t, s, r) => { t ? i(t) : e(s) }) }) } get(t) { return this.send.call(this.env, t) } post(t) { return this.send.call(this.env, t, "POST") } } return new class { constructor(t, e) { this.name = t, this.http = new s(this), this.data = null, this.dataFile = "box.dat", this.logs = [], this.isMute = !1, this.isNeedRewrite = !1, this.logSeparator = "\n", this.startTime = (new Date).getTime(), Object.assign(this, e), this.log("", `🔔${this.name}, 开始!`) } isNode() { return "undefined" != typeof module && !!module.exports } isQuanX() { return "undefined" != typeof $task } isSurge() { return "undefined" != typeof $httpClient && "undefined" == typeof $loon } isLoon() { return "undefined" != typeof $loon } toObj(t, e = null) { try { return JSON.parse(t) } catch { return e } } toStr(t, e = null) { try { return JSON.stringify(t) } catch { return e } } getjson(t, e) { let s = e; const i = this.getdata(t); if (i) try { s = JSON.parse(this.getdata(t)) } catch { } return s } setjson(t, e) { try { return this.setdata(JSON.stringify(t), e) } catch { return !1 } } getScript(t) { return new Promise(e => { this.get({ url: t }, (t, s, i) => e(i)) }) } runScript(t, e) { return new Promise(s => { let i = this.getdata("@chavy_boxjs_userCfgs.httpapi"); i = i ? i.replace(/\n/g, "").trim() : i; let r = this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout"); r = r ? 1 * r : 20, r = e && e.timeout ? e.timeout : r; const [o, h] = i.split("@"), n = { url: `http://${h}/v1/scripting/evaluate`, body: { script_text: t, mock_type: "cron", timeout: r }, headers: { "X-Key": o, Accept: "*/*" } }; this.post(n, (t, e, i) => s(i)) }).catch(t => this.logErr(t)) } loaddata() { if (!this.isNode()) return {}; { this.fs = this.fs ? this.fs : require("fs"), this.path = this.path ? this.path : require("path"); const t = this.path.resolve(this.dataFile), e = this.path.resolve(process.cwd(), this.dataFile), s = this.fs.existsSync(t), i = !s && this.fs.existsSync(e); if (!s && !i) return {}; { const i = s ? t : e; try { return JSON.parse(this.fs.readFileSync(i)) } catch (t) { return {} } } } } writedata() { if (this.isNode()) { this.fs = this.fs ? this.fs : require("fs"), this.path = this.path ? this.path : require("path"); const t = this.path.resolve(this.dataFile), e = this.path.resolve(process.cwd(), this.dataFile), s = this.fs.existsSync(t), i = !s && this.fs.existsSync(e), r = JSON.stringify(this.data); s ? this.fs.writeFileSync(t, r) : i ? this.fs.writeFileSync(e, r) : this.fs.writeFileSync(t, r) } } lodash_get(t, e, s) { const i = e.replace(/\[(\d+)\]/g, ".$1").split("."); let r = t; for (const t of i) if (r = Object(r)[t], void 0 === r) return s; return r } lodash_set(t, e, s) { return Object(t) !== t ? t : (Array.isArray(e) || (e = e.toString().match(/[^.[\]]+/g) || []), e.slice(0, -1).reduce((t, s, i) => Object(t[s]) === t[s] ? t[s] : t[s] = Math.abs(e[i + 1]) >> 0 == +e[i + 1] ? [] : {}, t)[e[e.length - 1]] = s, t) } getdata(t) { let e = this.getval(t); if (/^@/.test(t)) { const [, s, i] = /^@(.*?)\.(.*?)$/.exec(t), r = s ? this.getval(s) : ""; if (r) try { const t = JSON.parse(r); e = t ? this.lodash_get(t, i, "") : e } catch (t) { e = "" } } return e } setdata(t, e) { let s = !1; if (/^@/.test(e)) { const [, i, r] = /^@(.*?)\.(.*?)$/.exec(e), o = this.getval(i), h = i ? "null" === o ? null : o || "{}" : "{}"; try { const e = JSON.parse(h); this.lodash_set(e, r, t), s = this.setval(JSON.stringify(e), i) } catch (e) { const o = {}; this.lodash_set(o, r, t), s = this.setval(JSON.stringify(o), i) } } else s = this.setval(t, e); return s } getval(t) { return this.isSurge() || this.isLoon() ? $persistentStore.read(t) : this.isQuanX() ? $prefs.valueForKey(t) : this.isNode() ? (this.data = this.loaddata(), this.data[t]) : this.data && this.data[t] || null } setval(t, e) { return this.isSurge() || this.isLoon() ? $persistentStore.write(t, e) : this.isQuanX() ? $prefs.setValueForKey(t, e) : this.isNode() ? (this.data = this.loaddata(), this.data[e] = t, this.writedata(), !0) : this.data && this.data[e] || null } initGotEnv(t) { this.got = this.got ? this.got : require("got"), this.cktough = this.cktough ? this.cktough : require("tough-cookie"), this.ckjar = this.ckjar ? this.ckjar : new this.cktough.CookieJar, t && (t.headers = t.headers ? t.headers : {}, void 0 === t.headers.Cookie && void 0 === t.cookieJar && (t.cookieJar = this.ckjar)) } get(t, e = (() => { })) { t.headers && (delete t.headers["Content-Type"], delete t.headers["Content-Length"]), this.isSurge() || this.isLoon() ? (this.isSurge() && this.isNeedRewrite && (t.headers = t.headers || {}, Object.assign(t.headers, { "X-Surge-Skip-Scripting": !1 })), $httpClient.get(t, (t, s, i) => { !t && s && (s.body = i, s.statusCode = s.status), e(t, s, i) })) : this.isQuanX() ? (this.isNeedRewrite && (t.opts = t.opts || {}, Object.assign(t.opts, { hints: !1 })), $task.fetch(t).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => e(t))) : this.isNode() && (this.initGotEnv(t), this.got(t).on("redirect", (t, e) => { try { if (t.headers["set-cookie"]) { const s = t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString(); s && this.ckjar.setCookieSync(s, null), e.cookieJar = this.ckjar } } catch (t) { this.logErr(t) } }).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => { const { message: s, response: i } = t; e(s, i, i && i.body) })) } post(t, e = (() => { })) { if (t.body && t.headers && !t.headers["Content-Type"] && (t.headers["Content-Type"] = "application/x-www-form-urlencoded"), t.headers && delete t.headers["Content-Length"], this.isSurge() || this.isLoon()) this.isSurge() && this.isNeedRewrite && (t.headers = t.headers || {}, Object.assign(t.headers, { "X-Surge-Skip-Scripting": !1 })), $httpClient.post(t, (t, s, i) => { !t && s && (s.body = i, s.statusCode = s.status), e(t, s, i) }); else if (this.isQuanX()) t.method = "POST", this.isNeedRewrite && (t.opts = t.opts || {}, Object.assign(t.opts, { hints: !1 })), $task.fetch(t).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => e(t)); else if (this.isNode()) { this.initGotEnv(t); const { url: s, ...i } = t; this.got.post(s, i).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => { const { message: s, response: i } = t; e(s, i, i && i.body) }) } } time(t, e = null) { const s = e ? new Date(e) : new Date; let i = { "M+": s.getMonth() + 1, "d+": s.getDate(), "H+": s.getHours(), "m+": s.getMinutes(), "s+": s.getSeconds(), "q+": Math.floor((s.getMonth() + 3) / 3), S: s.getMilliseconds() }; /(y+)/.test(t) && (t = t.replace(RegExp.$1, (s.getFullYear() + "").substr(4 - RegExp.$1.length))); for (let e in i) new RegExp("(" + e + ")").test(t) && (t = t.replace(RegExp.$1, 1 == RegExp.$1.length ? i[e] : ("00" + i[e]).substr(("" + i[e]).length))); return t } msg(e = t, s = "", i = "", r) { const o = t => { if (!t) return t; if ("string" == typeof t) return this.isLoon() ? t : this.isQuanX() ? { "open-url": t } : this.isSurge() ? { url: t } : void 0; if ("object" == typeof t) { if (this.isLoon()) { let e = t.openUrl || t.url || t["open-url"], s = t.mediaUrl || t["media-url"]; return { openUrl: e, mediaUrl: s } } if (this.isQuanX()) { let e = t["open-url"] || t.url || t.openUrl, s = t["media-url"] || t.mediaUrl; return { "open-url": e, "media-url": s } } if (this.isSurge()) { let e = t.url || t.openUrl || t["open-url"]; return { url: e } } } }; if (this.isMute || (this.isSurge() || this.isLoon() ? $notification.post(e, s, i, o(r)) : this.isQuanX() && $notify(e, s, i, o(r))), !this.isMuteLog) { let t = ["", "==============📣系统通知📣=============="]; t.push(e), s && t.push(s), i && t.push(i), console.log(t.join("\n")), this.logs = this.logs.concat(t) } } log(...t) { t.length > 0 && (this.logs = [...this.logs, ...t]), console.log(t.join(this.logSeparator)) } logErr(t, e) { const s = !this.isSurge() && !this.isQuanX() && !this.isLoon(); s ? this.log("", `❗️${this.name}, 错误!`, t.stack) : this.log("", `❗️${this.name}, 错误!`, t) } wait(t) { return new Promise(e => setTimeout(e, t)) } done(t = {}) { const e = (new Date).getTime(), s = (e - this.startTime) / 1e3; this.log("", `🔔${this.name}, 结束! 🕛 ${s} 秒`), this.log(), (this.isSurge() || this.isQuanX() || this.isLoon()) && $done(t) } }(t, e) }
